{% extends "layout.html" %}
{% block content %}
<div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh;">
  <div class="card shadow-lg p-4" style="width: 100%; max-width: 500px;">

    <div class="d-flex justify-content-center mb-3">
      <div style="background: #e3f2fd; border-radius: 50%; width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px #b3e5fc;">
        <i class="bi bi-capsule" style="font-size:3rem; color:#039be5;"></i>
      </div>
    </div>

    <h2 class="fw-bold mb-2 text-center" style="font-size:2rem; color:#039be5;">Daily Pill Check</h2>
    <div class="mb-3 text-center" style="font-size:1.15rem; color:#333;">Check your daily medication</div>

    <div id="cameraError" class="text-danger text-center mb-2" style="display: none;"></div>

    <!-- CAMERA WRAPPER with floating switch button -->
    <div class="camera-wrapper mb-3" style="position: relative;">
      <video id="video" autoplay playsinline class="w-100 rounded border" style="aspect-ratio: 4/3; background: black;"></video>
      <button id="switchCameraBtn" title="Switch Camera" class="btn btn-light btn-sm rounded-circle shadow" 
              style="position: absolute; top: 10px; right: 10px; background-color: rgba(255, 255, 255, 0.85); border: none;">
        ðŸ”„
      </button>
    </div>

    <button id="captureBtn" class="btn btn-outline-dark w-100 mb-3">
      ðŸ“· Capture
    </button>

    <textarea id="textOutput" class="form-control mb-3" placeholder="Detected labels will appear here..." rows="3" readonly style="display: none;"></textarea>

    <div class="mb-3 text-center">
      <img id="result-img" src="" class="w-100 mb-3 rounded border" style="aspect-ratio: 4/3; display: none; cursor: pointer;" alt="Annotated Result">
      <div class="form-text">Annotated Result (Click to Zoom)</div>
    </div>

    <div class="mb-3">
      <label for="uploadImage" class="form-label">Or upload a photo of your pills</label>
      <input type="file" id="uploadImage" class="form-control mb-2" accept="image/*">
      <button id="uploadSubmitBtn" class="btn btn-primary w-100 mt-2">ðŸš€ Submit Upload</button>
    </div>
  </div>
</div>

<!-- Modal for zooming image -->
<div id="imageModal" style="display:none; position:fixed; z-index:9999; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.85);">
  <span id="closeModalBtn" style="position:absolute; top:15px; right:25px; font-size:40px; font-weight:bold; color:white; cursor:pointer;">&times;</span>
  <img id="zoomedImage" style="max-width:90vw; max-height:90vh; display:block; margin:5% auto; border-radius:12px;">
</div>
{% endblock %}
